/**
 * https://github.com/IDEAFY/Ideafy
 * Proprietary License - All rights reserved
 * Author: Vincent Weyl <vincent@ideafy.com>
 * Copyright (c) 2014 IDEAFY LLC
 */

define(["OObject","Place.plugin","Amy/Stack-plugin","Amy/Control-plugin","public/public","library/library","brainstorm/brainstorm","connect/connect","dashboard/dashboard","service/map","service/config","./notify","service/newidea","service/help","service/new2q","service/new2c","service/tips"],function(e,t,s,i,n,a,o,l,r,d,c,u,p,g,m,v,b){return function(){var g,v,h,f,w,y,L,k,S=new e,T=new u,M=new i(this),q=c.get("observer"),H=c.get("user"),x=new s;return S.plugins.addAll({dockstack:x,dockcontrol:M,place:new t({notify:T})}),S.template='<div id="wrapper"><nav id="dock" data-dockcontrol="radio:a,selected,mousedown,setCurrentWidget"><a class="dock-item selected" href="#public" data-dockcontrol="init"></a><a class="dock-item" href="#library"></a><a class="dock-item" href="#brainstorm"></a><a class="dock-item" href="#connect"></a><a class="dock-item" href="#dashboard"></a></nav><div class="stack" data-dockstack="destination"></div><div id="notify" data-place="place:notify"></div></div>',S.place(d.get("dock")),S.setDisplay=function(){var e=window.innerWidth,t=window.innerHeight,s=S.dom.clientWidth||1024,i=S.dom.clientHeight||748,n="";e>s&&(n+="left:50%; margin-left:-"+s/2+"px;"),t>i&&(n+="top:50%; margin-top:-"+i/2+"px;"),S.dom.setAttribute("style",n)},S.init=function(){S.setDisplay(),f=new n,console.log("public ok"),w=new a,console.log("library ok"),y=new o,console.log("brainstorm ok"),L=new l,console.log("connect ok"),k=new r,console.log("dashboard ok"),x.getStack().add("#public",f),x.getStack().add("#library",w),x.getStack().add("#brainstorm",y),x.getStack().add("#connect",L),x.getStack().add("#dashboard",k),T.init(),g=new p,v=new m,h=new b},S.start=function(e){var t=S.dom.querySelector('a[href="#public"]'),s=S.dom.querySelector('a[href="#dashboard"]'),i=S.dom.querySelector("a.selected"),n=S.dom.querySelector('a[href="'+H.get("settings").startupScreen+'"]');H.get("settings").startupScreen||H.get("resetPWD")?H.get("resetPWD")?(M.radioClass(s,i,"selected"),M.init(s),x.getStack().show("#dashboard")):(M.radioClass(n,i,"selected"),M.init(n),x.getStack().show(H.get("settings").startupScreen)):(i!==t&&(M.radioClass(t,i,"selected"),M.init(t)),x.getStack().show("#public")),(e||H.get("settings").showTips!==!1)&&h.init(e)},S.reset=function(){f.reset(),w.reset(),y.reset(),L.reset(),k.reset(),T.reset()},this.setCurrentWidget=function(e){var t=e.target.getAttribute("href"),s=1500;e.preventDefault(),t!==x.getStack().getCurrentName()?(x.getStack().getCurrentScreen().hideMenu(),x.getStack().show(t),x.getStack().getCurrentScreen().showMenu(),setTimeout(function(){x.getStack().getCurrentScreen().hideMenu()},s)):x.getStack().getCurrentScreen().showMenu()},q.watch("replay-session",function(){var e=document.querySelector(".dock-item.selected"),t=document.querySelector(".dock-item[href='#brainstorm']");x.getStack().show("#brainstorm"),M.radioClass(t,e,"selected"),M.init(t)}),q.watch("display-doc",function(){var e=document.querySelector(".dock-item.selected"),t=document.querySelector(".dock-item[href='#library']");x.getStack().show("#library"),M.radioClass(t,e,"selected"),M.init(t)}),q.watch("display-message",function(){var e=document.querySelector(".dock-item.selected"),t=document.querySelector(".dock-item[href='#connect']");x.getStack().show("#connect"),M.radioClass(t,e,"selected"),M.init(t)}),q.watch("display-tutorials",function(){var e=document.querySelector(".dock-item.selected"),t=document.querySelector(".dock-item[href='#dashboard']");x.getStack().show("#dashboard"),M.radioClass(t,e,"selected"),M.init(t)}),q.watch("join-musession",function(){var e=document.querySelector(".dock-item.selected"),t=document.querySelector(".dock-item[href='#brainstorm']");"#brainstorm"!==x.getStack().getCurrentName()&&(x.getStack().show("#brainstorm"),M.radioClass(t,e,"selected"),M.init(t))}),q.watch("goto-screen",function(e){var t=document.querySelector(".dock-item.selected"),s=document.querySelector(".dock-item[href='"+e+"']");x.getStack().getCurrentName()!==e&&(x.getStack().show(e),M.radioClass(s,t,"selected"),M.init(s))}),S}});