/**
 * https://github.com/IDEAFY/Ideafy
 * Proprietary License - All rights reserved
 * Author: Vincent Weyl <vincent@ideafy.com>
 * Copyright (c) 2014 IDEAFY LLC
 */

define(["OObject","Bind.plugin","Event.plugin","service/config","Store","service/utils"],function(e,t,i,n,s){function a(){var e=this,a=n.get("labels"),o=new s({hour:0,min:0,am:!0});e.plugins.addAll({label:new t(a),model:new t(o,{displayAMPM:function(e){12>e?this.classList.remove("invisible"):this.classList.add("invisible")}}),event:new i(this)}),e.template='<div class = "timeui"><div class="timeicon"></div><input type="number" maxlength="2" max="23" name="hour" data-model="bind:value, hour" data-event="listen:blur, format">:<input type="number" maxlength="2" max="59" name="min" data-model="bind:value, min" data-event="listen:blur, format"></select><select name="am" class="invisible" data-model="bind:displayAMPM, hour" data-event="listen: change, setAMPM"><option>AM</option><option>PM</option></select></div>',e.getTime=function(){var e,t=o.get("min");return e=o.get("am")?o.get("hour"):parseInt(o.get("hour"))+12,[e,t,0]},e.format=function(e,t){var i=t.value,n=t.getAttribute("name");/[0-9]/.test(i)||o.set(n,"00"),10>i&&(t.value="0"+i),"hour"===n&&i>23&&o.set(n,"00"),"min"===n&&i>59&&o.set(n,"00")},e.setAMPM=function(e,t){1===t.selectedIndex?o.set("am",!1):o.set("am",!0)},e.getTimestamp=function(){var e,t=(new Date).getTimezoneOffset(),i=parseInt(o.get("min"),10)||0;return e=o.get("am")?parseInt(o.get("hour"),10):parseInt(o.get("hour"),10)+12,1e3*(3600*e+60*i+t)},e.setTime=function(e,t,i){var n=new Date,s=e||n.getHours(),a=t||n.getMinutes(),r=i;o.set("hour",s),o.set("min",a),o.set("am",r)},e.reset=function(){e.setTime()},e.render(),e.reset()}return function(){return a.prototype=new e,new a}});